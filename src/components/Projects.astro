---
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
---

<div class="columns-1 sm:columns-2 md:columns-3 gap-6 [column-fill:_balance]">
  {
    projects.map((project, index) => {
      const { slug, data } = project;
      const { name, cover } = data;

      return (
        <article class="mb-6 break-inside-avoid">
          <a 
            href={`/project/${slug}`} 
            class="block overflow-hidden rounded-xl transition-transform duration-500 ease-out hover:[&_img]:scale-105 hover:[&_img]:brightness-105"
          >
            <img
              src={`/images/covers/${cover}`}
              alt={`${name} image`}
              width="500"
              height="300"
              class="w-full h-auto transition-transform duration-500 ease-out"
              loading={index >= 1 ? "lazy" : "eager"}
              fetchpriority={index === 0 ? "high" : "low"}
            />
          </a>
          <h3 class="mt-2 text-pretty">{name}</h3>
        </article>
      )
    })
  }
</div>
